# Нагрузочное тестирование

Этот каталог содержит скрипты для нагрузочного тестирования приложения с использованием [k6](https://k6.io/).

## Установка k6

Перед запуском тестов необходимо установить k6:

### macOS

```bash
brew install k6
```

### Linux

```bash
sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys C5AD17C747E3415A3642D57D77C6C491D6AC1D69
echo "deb https://dl.k6.io/deb stable main" | sudo tee /etc/apt/sources.list.d/k6.list
sudo apt-get update
sudo apt-get install k6
```

### Windows

```bash
choco install k6
```

## Запуск тестов

Перед запуском тестов убедитесь, что приложение запущено на `http://localhost:3000`.

### Базовый тест

```bash
k6 run load-tests/basic.js
```

Этот тест симулирует 10 пользователей, которые одновременно используют приложение в течение 30 секунд.

### Стресс-тест

```bash
k6 run load-tests/stress.js
```

Этот тест постепенно увеличивает нагрузку от 0 до 100 пользователей, а затем снижает ее обратно до 0.

## Интерпретация результатов

После завершения теста k6 выводит подробный отчет, включающий:

- Общее количество запросов
- Скорость запросов (запросов в секунду)
- Время отклика (минимальное, максимальное, среднее, медианное, 90-й и 95-й процентили)
- Процент успешных/неудачных запросов
- Использование ресурсов (CPU, память)

Обратите внимание на следующие ключевые метрики:

- **http_req_duration**: Время выполнения запроса. Целевое значение: p95 < 500 мс
- **http_req_failed**: Процент неудачных запросов. Целевое значение: < 1%
- **iterations**: Общее количество выполненных итераций
- **vus**: Количество виртуальных пользователей

## Пороговые значения

В скриптах определены пороговые значения (thresholds), которые определяют успешность теста:

- 95% запросов должны завершаться менее чем за 500 мс
- Не более 1% запросов должны завершаться с ошибкой
- Пользовательская метрика: не более 5 неудачных запросов

Если какое-либо из этих условий не выполняется, тест считается неуспешным.
